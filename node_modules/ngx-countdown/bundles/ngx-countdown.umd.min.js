!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define("ngx-countdown",["exports","@angular/core","@angular/common"],e):e((t=t||self)["ngx-countdown"]={},t.ng.core,t.ng.common)}(this,(function(t,e,n){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var o,i=function(){return(i=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function s(t,e,n,o){var i,s=arguments.length,r=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(s<3?i(r):s>3?i(e,n,r):i(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r}function r(t,e){return function(n,o){e(n,o,t)}}function a(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}(o=t.CountdownStatus||(t.CountdownStatus={}))[o.ing=0]="ing",o[o.pause=1]="pause",o[o.stop=2]="stop",o[o.done=3]="done";var u=function(){function t(t){this.ngZone=t,this.fns=[],this.commands=[],this.ing=!1}return t.prototype.start=function(){var t=this;!0!==this.ing&&(this.ing=!0,this.nextTime=+new Date,this.ngZone.runOutsideAngular((function(){t.process()})))},t.prototype.process=function(){for(var t=this;this.commands.length;)this.commands.shift()();var e=+new Date-this.nextTime,n=1+Math.floor(e/100);e=100-e%100,this.nextTime+=100*n;for(var o=0,i=this.fns.length;o<i;o+=2){var s=this.fns[o+1];if(0===s)this.fns[o](n);else{s+=2*n-1;var r=Math.floor(s/20);r>0&&this.fns[o](r),this.fns[o+1]=s%20+1}}this.ing&&setTimeout((function(){return t.process()}),e)},t.prototype.add=function(t,e){var n=this;return this.commands.push((function(){n.fns.push(t),n.fns.push(1e3===e?1:0),n.ing=!0})),this},t.prototype.remove=function(t){var e=this;return this.commands.push((function(){var n=e.fns.indexOf(t);-1!==n&&e.fns.splice(n,2),e.ing=e.fns.length>0})),this},t.ctorParameters=function(){return[{type:e.NgZone}]},t=s([e.Injectable(),a("design:paramtypes",[e.NgZone])],t)}(),f=function(){function t(t){var e=this;this.locale=t,this.demand=!1,this.leftTime=0,this.format="HH:mm:ss",this.timezone="+0000",this.formatDate=function(t){var o=t.date,i=t.formatStr,s=t.timezone;return n.formatDate(new Date(o),i,e.locale,s||e.timezone||"+0000")}}return t.ctorParameters=function(){return[{type:String,decorators:[{type:e.Inject,args:[e.LOCALE_ID]}]}]},t.ɵprov=e["ɵɵdefineInjectable"]({factory:function(){return new t(e["ɵɵinject"](e.LOCALE_ID))},token:t,providedIn:"root"}),t=s([e.Injectable({providedIn:"root"}),r(0,e.Inject(e.LOCALE_ID)),a("design:paramtypes",[String])],t)}(),c=function(){function n(n,o,i,s,r){this.locale=n,this.timer=o,this.defCog=i,this.cdr=s,this.ngZone=r,this.frequency=1e3,this._notify={},this._left=0,this.status=t.CountdownStatus.ing,this.isDestroy=!1,this.i={},this.event=new e.EventEmitter}return Object.defineProperty(n.prototype,"left",{get:function(){return this._left},enumerable:!0,configurable:!0}),n.prototype.begin=function(){this.status=t.CountdownStatus.ing,this.callEvent("start")},n.prototype.restart=function(){this.status!==t.CountdownStatus.stop&&this.destroy(),this.init(),this.callEvent("restart")},n.prototype.stop=function(){this.status!==t.CountdownStatus.stop&&(this.status=t.CountdownStatus.stop,this.destroy(),this.callEvent("stop"))},n.prototype.pause=function(){this.status!==t.CountdownStatus.stop&&this.status!==t.CountdownStatus.pause&&(this.status=t.CountdownStatus.pause,this.callEvent("pause"))},n.prototype.resume=function(){this.status!==t.CountdownStatus.stop&&this.status===t.CountdownStatus.pause&&(this.status=t.CountdownStatus.ing,this.callEvent("resume"))},n.prototype.callEvent=function(t){this.event.emit({action:t,left:this._left,status:this.status,text:this.i.text})},n.prototype.init=function(){var e=this,n=this.locale,o=this.defCog,s=this.config=i(i(i({},new f(n)),o),this.config),r=this.frequency=~s.format.indexOf("S")?100:1e3;this.status=s.demand?t.CountdownStatus.pause:t.CountdownStatus.ing,this.getLeft();var a=this.reflow;this.reflow=function(t,n){return void 0===t&&(t=0),void 0===n&&(n=!1),a.apply(e,[t,n])},Array.isArray(s.notify)&&s.notify.forEach((function(t){if(t<1)throw new Error("The notify config must be a positive integer.");t*=1e3,t-=t%r,e._notify[t]=!0})),this.timer.add(this.reflow,r).start(),this.reflow(0,!0)},n.prototype.destroy=function(){return this.timer.remove(this.reflow),this},n.prototype.reflow=function(e,n){var o=this;if(void 0===e&&(e=0),void 0===n&&(n=!1),!this.isDestroy){var i=this.status,s=this.config,r=this._notify;if(n||i===t.CountdownStatus.ing){var a=this._left=this._left-this.frequency*e;this.i={value:a,text:s.formatDate({date:a,formatStr:s.format,timezone:s.timezone})},"function"==typeof s.prettyText&&(this.i.text=s.prettyText(this.i.text)),this.cdr.detectChanges(),(0===s.notify||r[a])&&this.ngZone.run((function(){o.callEvent("notify")})),a<1&&this.ngZone.run((function(){o.status=t.CountdownStatus.done,o.callEvent("done"),o.destroy()}))}}},n.prototype.getLeft=function(){var t=this.config,e=this.frequency,n=1e3*t.leftTime,o=t.stopTime;!n&&o&&(n=o-(new Date).getTime()),this._left=n-n%e},n.prototype.ngOnInit=function(){this.init(),this.config.demand||this.begin()},n.prototype.ngOnDestroy=function(){this.isDestroy=!0,this.destroy()},n.prototype.ngOnChanges=function(t){t.config.firstChange||this.restart()},n.ctorParameters=function(){return[{type:String,decorators:[{type:e.Inject,args:[e.LOCALE_ID]}]},{type:u},{type:f},{type:e.ChangeDetectorRef},{type:e.NgZone}]},s([e.Input(),a("design:type",Object)],n.prototype,"config",void 0),s([e.Input(),a("design:type",e.TemplateRef)],n.prototype,"render",void 0),s([e.Output(),a("design:type",Object)],n.prototype,"event",void 0),n=s([e.Component({selector:"countdown",template:'\n    <ng-container *ngIf="!render">\n      <span [innerHTML]="i.text"></span>\n    </ng-container>\n    <ng-container *ngTemplateOutlet="render; context: { $implicit: i }"></ng-container>\n  ',host:{"[class.count-down]":"true"},encapsulation:e.ViewEncapsulation.None,changeDetection:e.ChangeDetectionStrategy.OnPush}),r(0,e.Inject(e.LOCALE_ID)),a("design:paramtypes",[String,u,f,e.ChangeDetectorRef,e.NgZone])],n)}(),h=function(){function t(){}return t=s([e.NgModule({imports:[n.CommonModule],providers:[u],declarations:[c],exports:[c]})],t)}();t.CountdownComponent=c,t.CountdownGlobalConfig=f,t.CountdownModule=h,t.CountdownTimer=u,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-countdown.umd.min.js.map