{"version":3,"sources":["src/app/pages/history/history.page.html","src/app/pages/history/history.module.ts","src/app/pages/history/history.page.scss","src/app/pages/history/history.page.ts"],"names":[],"mappings":"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","sourcesContent":["export default \"<ion-header >\\r\\n  <ion-toolbar>\\r\\n    <ion-title>History</ion-title>\\r\\n    <ion-buttons slot=\\\"primary\\\">\\r\\n      <ion-button left routerLink=\\\"/\\\" routerDirection=\\\"root\\\" fill=\\\"clear\\\" slot=\\\"primary\\\">\\r\\n        Logout<ion-icon name=\\\"log-out\\\"></ion-icon>\\r\\n      </ion-button>\\r\\n    </ion-buttons>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-card>\\r\\n  <ion-list>\\r\\n    <ion-item>\\r\\n      <ion-label position=\\\"stacked\\\">Vehicle Type</ion-label>\\r\\n      <ion-select id=\\\"vehitype\\\" interface=\\\"popover\\\" value=\\\"ALL\\\">\\r\\n        <ion-select-option value=\\\"ALL\\\">ALL</ion-select-option>\\r\\n        <ion-select-option *ngFor =\\\"let vehicle of database.current.stats.most_recent_drive_by_vehicle_type | keyvalue\\\" value={{vehicle.key}} class=\\\"custom-font-size\\\">{{vehicle.key}}</ion-select-option>\\r\\n      </ion-select>\\r\\n    </ion-item>\\r\\n  </ion-list>\\r\\n</ion-card>\\r\\n\\r\\n<ion-content>\\r\\n\\r\\n  <!-- Month/date Selector (Sticky header) -->\\r\\n\\r\\n  <ion-item-divider sticky>\\r\\n    <ion-grid>\\r\\n      <ion-row class=\\\"vertical-align-content\\\">\\r\\n        <ion-col no-padding text-center size=3>\\r\\n            <ion-button size=\\\"small\\\" (click)=\\\"incrementFilterPeriod(-1)\\\"><ion-icon name=\\\"return-left\\\"></ion-icon></ion-button>\\r\\n        </ion-col>\\r\\n\\r\\n        <ion-col no-padding text-center>\\r\\n          <h4>{{getFilterPeriodString()}}</h4>\\r\\n        </ion-col>\\r\\n\\r\\n        <ion-col no-padding text-center size=3>\\r\\n            <ion-button size=\\\"small\\\" (click)=\\\"incrementFilterPeriod(+1)\\\"><ion-icon name=\\\"return-right\\\"></ion-icon></ion-button>\\r\\n        </ion-col>\\r\\n\\r\\n      </ion-row>\\r\\n    </ion-grid>\\r\\n  </ion-item-divider>\\r\\n\\r\\n  <div style=\\\"display: block\\\">\\r\\n    <canvas baseChart\\r\\n                [data]=\\\"chartData\\\"\\r\\n                [labels]=\\\"chartLabels\\\"\\r\\n                [chartType]=\\\"chartType\\\"\\r\\n                [colors]=\\\"chartColors\\\"\\r\\n                (chartHover)=\\\"chartHovered($event)\\\"\\r\\n                (chartClick)=\\\"chartClicked($event)\\\"></canvas>\\r\\n  </div>\\r\\n\\r\\n  <ion-card>\\r\\n      <div class=\\\"ion-text-center\\\" style=\\\"width: 100%;\\\">\\r\\n        <ion-icon name=\\\"speedometer\\\" size=\\\"small\\\"></ion-icon>\\r\\n        <ion-label class=\\\"slide_num\\\" *ngIf=\\\"getFilterPeriodString()=='All'\\\"> Total Mileage: {{getMileage()}} km</ion-label>\\r\\n        <ion-label *ngIf=\\\"getFilterPeriodString()!='All'\\\" class=\\\"slide_num\\\"> {{getFilterPeriodString()}} Total Mileage: {{getMileage()}} km</ion-label><br>\\r\\n        <ion-col *ngFor=\\\"let vehicle of database.current.stats.most_recent_drive_by_vehicle_type | keyvalue\\\">\\r\\n          {{vehicle.key}} : {{getMileagebyVehicleType(vehicle.key)}}\\r\\n        </ion-col>\\r\\n      </div>\\r\\n  </ion-card>\\r\\n\\r\\n  <ion-card *ngFor=\\\"let trip of getDrives()\\\">\\r\\n    <br>\\r\\n    <app-drive-view expandHeight='150px' expandWidth='100px' [drive]=\\\"trip\\\"></app-drive-view>\\r\\n  </ion-card>\\r\\n\\r\\n</ion-content>\\r\\n<!--\\r\\n    <ion-row >\\r\\n      <ion-col align=\\\"center\\\">\\r\\n      <ion-card >\\r\\n    <ion-card-header>\\r\\n      <ion-card-subtitle>\\r\\n          <ion-item class=\\\"card\\\">\\r\\n          <ion-label position=\\\"floating\\\"></ion-label>\\r\\n          <ion-input disabled type=\\\"date\\\" name=\\\"text_drivedate\\\" color=\\\"success\\\">  </ion-input>\\r\\n            </ion-item>\\r\\n        </ion-card-subtitle>\\r\\n      <ion-card-title>\\r\\n        <ion-item class=\\\"card\\\" >\\r\\n          <ion-label color=\\\"success\\\" position=\\\"floating\\\">VehicleType</ion-label>\\r\\n          <ion-input color=\\\"success\\\" disabled type=\\\"number\\\" name=\\\"text_drivevehicletype\\\">  </ion-input>\\r\\n            </ion-item>\\r\\n    </ion-card-title>\\r\\n    </ion-card-header>\\r\\n  \\r\\n    <ion-card-content>\\r\\n      \\r\\n      <ion-grid>\\r\\n        <ion-row>\\r\\n          <ion-col >\\r\\n            <ion-item class=\\\"card\\\">\\r\\n          <ion-label color=\\\"success\\\" position=\\\"floating\\\">Total Time Driven</ion-label>\\r\\n          <ion-input disabled type=\\\"number\\\" name=\\\"text_driveduration\\\" color=\\\"success\\\">  </ion-input>\\r\\n            </ion-item>\\r\\n          </ion-col>\\r\\n          <ion-col>\\r\\n            <ion-item class=\\\"card\\\">\\r\\n          <ion-label color=\\\"success\\\" position=\\\"floating\\\">Total Mileage</ion-label>\\r\\n          <ion-input disabled type=\\\"number\\\" name=\\\"text_drivemileage\\\" color=\\\"success\\\">  </ion-input>\\r\\n            </ion-item>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n      </ion-grid>\\r\\n\\r\\n    </ion-card-content>\\r\\n  </ion-card>\\r\\n\\r\\n      </ion-col>\\r\\n    </ion-row>\\r\\n-->\\r\\n\\r\\n\"","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { HistoryPage } from './history.page';\r\nimport { DriveViewModule } from '../../drive-view/drive-view.module';\r\nimport { ChartsModule } from 'ng2-charts';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: HistoryPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    RouterModule.forChild(routes),\r\nDriveViewModule,\r\nChartsModule\r\n  ],\r\n  declarations: [HistoryPage\r\n  ]\r\n})\r\nexport class HistoryPageModule {}\r\n","export default \".vertical-align-content > * {\\n  display: -webkit-box !important;\\n  display: flex !important;\\n  align-content: center !important;\\n  -webkit-box-align: center !important;\\n          align-items: center !important;\\n  -webkit-box-pack: center !important;\\n          justify-content: center !important; }\\n\\n.custom-font-size {\\n  font-size: 0.8em; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvaGlzdG9yeS9DOlxcVXNlcnNcXFJ1aVxcQW5kcm9pZFN0dWRpb1Byb2plY3RzXFxFbmdpbmVlcnNMb2dib29rMi9zcmNcXGFwcFxccGFnZXNcXGhpc3RvcnlcXGhpc3RvcnkucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBRUssK0JBQXVCO0VBQXZCLHdCQUF1QjtFQUN2QixnQ0FBK0I7RUFDL0Isb0NBQTZCO1VBQTdCLDhCQUE2QjtFQUM3QixtQ0FBa0M7VUFBbEMsa0NBQWtDLEVBQUE7O0FBRXZDO0VBQ0ksZ0JBQWdCLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9wYWdlcy9oaXN0b3J5L2hpc3RvcnkucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLnZlcnRpY2FsLWFsaWduLWNvbnRlbnQgPiAqXHJcbntcclxuICAgICBkaXNwbGF5OiBmbGV4IWltcG9ydGFudDtcclxuICAgICBhbGlnbi1jb250ZW50OiBjZW50ZXIhaW1wb3J0YW50O1xyXG4gICAgIGFsaWduLWl0ZW1zOiBjZW50ZXIhaW1wb3J0YW50OyAgLy8gdmVydGljYWwgYWxpZ25tZW50XHJcbiAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXIgIWltcG9ydGFudDsgIC8vIGhvcml6b250YWwgYWxpZ25tZW50XHJcbn1cclxuLmN1c3RvbS1mb250LXNpemUge1xyXG4gICAgZm9udC1zaXplOiAwLjhlbTtcclxufSJdfQ== */\"","import { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\r\nimport { DatabaseService, Drive, VehicleTypes } from '../../services/database.service';\r\nimport * as dayjs from 'dayjs'; // DateTime utility, See http://zetcode.com/javascript/dayjs/\r\nimport { Chart } from \"chart.js\";\r\nimport { PipesModule } from '../../pipes/pipes.module';\r\nimport 'chartjs-plugin-labels';\r\nimport 'chartjs-chart-radial-gauge';\r\nimport 'chartjs-tsgauge';\r\nimport {ChartsModule, Color} from 'ng2-charts';\r\nimport { Geolocation } from '@ionic-native/geolocation/ngx';\r\n\r\n@Component({\r\n  selector: 'app-history',\r\n  templateUrl: './history.page.html',\r\n  styleUrls: ['./history.page.scss'],\r\n})\r\nexport class HistoryPage implements OnInit {\r\n\r\n  select_month: number = 0;\r\n  select_year: number = 0;\r\n  \r\n  constructor(\r\n    private database: DatabaseService,\r\n    private geolocation: Geolocation,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.buildChart();\r\n    let watch = this.geolocation.watchPosition();\r\n    watch.subscribe((data) => {\r\n      if ( ( parseFloat(data.coords.latitude.toFixed(9)), parseFloat(data.coords.longitude.toFixed(9)) ) != (this.database.current.user.location.lat, this.database.current.user.location.lng) )\r\n      { this.database.current.user.location = {lat: parseFloat(data.coords.latitude.toFixed(9)),lng: parseFloat(data.coords.longitude.toFixed(9))};\r\n        console.log(this.database.current.user.location);\r\n        console.log(\"write\");\r\n        this.database.write('user', this.database.current.user.email, this.database.current.user);\r\n      }\r\n    });\r\n  }\r\n\r\n  public getMileage() {\r\n    var mileage = 0;\r\n    var drives = this.getDrives();\r\n    for (var d of drives) {\r\n      mileage += d.end_odometer - d.start_odometer }\r\n    return mileage;\r\n  }\r\n\r\n  getMileagebyVehicleType(vehicle: string) {\r\n    var mileage = 0;\r\n    var drives = this.getDrives();\r\n    for (var d of drives) {\r\n      if (d.vehicle_type == vehicle) {\r\n        mileage += d.end_odometer - d.start_odometer }\r\n      }\r\n    return mileage;\r\n  }\r\n\r\n  public getDrives() : Drive[] {\r\n\r\n    var drives = this.database.current.drive_history;\r\n    var vtype = (<HTMLInputElement>document.getElementById(\"vehitype\")).value;\r\n    if (!this.select_month && !this.select_year) {\r\n      if (vtype != \"ALL\") {\r\n        return drives.filter( (drive) => drive.vehicle_type == vtype);\r\n      }\r\n      return drives\r\n    }\r\n    else {\r\n      if (vtype != \"ALL\") {\r\n        var  a = drives.filter( (drive) => drive.vehicle_type == vtype);\r\n        return a.filter( (drive) => {\r\n          var elem = drive.date.split(\"-\");\r\n          return (!this.select_year||parseInt(elem[0])==this.select_year)\r\n            && (!this.select_month||parseInt(elem[1])==this.select_month);\r\n        });\r\n      }\r\n      return drives.filter( (drive) => {\r\n        var elem = drive.date.split(\"-\");\r\n        return (!this.select_year||parseInt(elem[0])==this.select_year)\r\n          && (!this.select_month||parseInt(elem[1])==this.select_month);\r\n      });\r\n    }\r\n  }\r\n\r\n  /*public getDrives() : Drive[] {\r\n\r\n    var drives = this.database.current.drive_history;\r\n\r\n    if (!this.select_month && !this.select_year) return drives; // No filter\r\n\r\n    return drives.filter( (drive) => {\r\n      var elem = drive.date.split(\"-\");\r\n      return (!this.select_year||parseInt(elem[0])==this.select_year) \r\n        && (!this.select_month||parseInt(elem[1])==this.select_month);\r\n    });\r\n  }*/\r\n  \r\n  public getFilterPeriodString(): string {\r\n    if (this.select_month==0 || this.select_year==0) {\r\n      return \"All\";\r\n    } else {\r\n      const dt = dayjs(new Date(this.select_year, this.select_month-1, 1));  // months in dayjs, Jan=0\r\n      return dt.format(\"MMMM, YYYY\");\r\n    }\r\n  }\r\n  \r\n  public incrementFilterPeriod(delta: number) {\r\n\r\n    const today = dayjs();\r\n\r\n    var changed: boolean = true;\r\n    \r\n    if (delta==-1) {\r\n      if (!this.select_month || !this.select_year) {\r\n        // Current month/year\r\n        this.select_month = today.month()+1;\r\n        this.select_year = today.year();\r\n      } else {\r\n        this.select_month--;\r\n        if (this.select_month==0) { \r\n          // Roll back to previous year\r\n          this.select_year--; \r\n          this.select_month = 12;\r\n        }\r\n      }\r\n    } else {\r\n      if (!this.select_month || !this.select_year) {\r\n        // Can't increment\r\n        changed = false;\r\n      } else {\r\n        // When incrementing beyond current month/year, select \"all\"\r\n        if (this.select_year==today.year() && (this.select_month-1)==today.month()) {\r\n          this.select_year = this.select_month = 0;\r\n        } else {\r\n          this.select_month++;\r\n          if (this.select_month==13) { \r\n            // Roll over to next year\r\n            this.select_year++; \r\n            this.select_month = 1;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (changed) this.buildChart();\r\n  }\r\n\r\n  // Build Doughnut chart of mileage per VehicleType\r\n  public chartLabels:string[] = Object.keys(this.database.current.stats.most_recent_drive_by_vehicle_type);\r\n  public chartData:number[] = [ 0,0,0,0 ];\r\n  public chartType:string = 'doughnut';\r\n  public chartColors:any[] = [{backgroundColor: [\r\n            \"rgba(255,99,132,0.2)\",\r\n            \"rgba(54, 162, 235,0.2)\",\r\n            \"rgba(255, 206, 86,0.2)\",\r\n            \"rgba(75, 192, 192,0.2)\",\r\n            \"rgba(153, 102, 255,0.2)\",],\r\n            borderColor: [\r\n            \"rgba(255,99,132, 1)\",\r\n            \"rgba(54, 162, 235, 1)\",\r\n            \"rgba(255, 206, 86, 1)\",\r\n            \"rgba(75, 192, 192, 1)\",\r\n            \"rgba(153, 102, 255, 1)\",]\r\n            }];\r\n\r\n  private buildChart(): void {\r\n\r\n    var count:number[] = Array(this.chartLabels.length).fill(0)\r\n    \r\n    this.getDrives().map( (trip) => {\r\n      var valid_type = false;\r\n      for (let i=0; i<this.chartLabels.length; i++) {\r\n        if (trip.vehicle_type === this.chartLabels[i]) {\r\n          count[i] += this.database.distance(trip);\r\n          valid_type = true;\r\n        }\r\n      }\r\n      if (!valid_type) { console.log(`### Error: Invalid vehicle type: ${trip.vehicle_type} in ${trip.id}`); }\r\n    });\r\n    \r\n    //console.log(`>buildChart() = ${count}`);\r\n    this.chartData = count;\r\n  }\r\n  \r\n  public chartClicked(e:any):void {\r\n    //console.log(e);\r\n  }\r\n  public chartHovered(e:any):void {\r\n    //console.log(e);\r\n  }\r\n}\r\n"],"sourceRoot":"webpack:///","file":"pages-history-history-module-es5.js"}