{"version":3,"sources":["./src/app/pages/history/history.page.html","./src/app/pages/history/history.module.ts","./src/app/pages/history/history.page.scss","./src/app/pages/history/history.page.ts"],"names":[],"mappings":"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","file":"pages-history-history-module-es2015.js","sourcesContent":["export default \"<ion-header >\\r\\n  <ion-toolbar>\\r\\n    <ion-title>History</ion-title>\\r\\n    <ion-buttons slot=\\\"primary\\\">\\r\\n      <ion-button left routerLink=\\\"/\\\" routerDirection=\\\"root\\\" fill=\\\"clear\\\" slot=\\\"primary\\\">\\r\\n        Logout<ion-icon name=\\\"log-out\\\"></ion-icon>\\r\\n      </ion-button>\\r\\n    </ion-buttons>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-card>\\r\\n  <ion-list>\\r\\n    <ion-item>\\r\\n      <ion-label position=\\\"stacked\\\">Vehicle Type</ion-label>\\r\\n      <ion-select id=\\\"vehitype\\\" interface=\\\"popover\\\" value=\\\"ALL\\\">\\r\\n        <ion-select-option value=\\\"ALL\\\">ALL</ion-select-option>\\r\\n        <ion-select-option *ngFor =\\\"let vehicle of database.current.stats.most_recent_drive_by_vehicle_type | keyvalue\\\" value={{vehicle.key}} class=\\\"custom-font-size\\\">{{vehicle.key}}</ion-select-option>\\r\\n      </ion-select>\\r\\n    </ion-item>\\r\\n  </ion-list>\\r\\n</ion-card>\\r\\n\\r\\n<ion-content>\\r\\n\\r\\n  <!-- Month/date Selector (Sticky header) -->\\r\\n\\r\\n  <ion-item-divider sticky>\\r\\n    <ion-grid>\\r\\n      <ion-row class=\\\"vertical-align-content\\\">\\r\\n        <ion-col no-padding text-center size=3>\\r\\n            <ion-button size=\\\"small\\\" (click)=\\\"incrementFilterPeriod(-1)\\\"><ion-icon name=\\\"return-left\\\"></ion-icon></ion-button>\\r\\n        </ion-col>\\r\\n\\r\\n        <ion-col no-padding text-center>\\r\\n          <h4>{{getFilterPeriodString()}}</h4>\\r\\n        </ion-col>\\r\\n\\r\\n        <ion-col no-padding text-center size=3>\\r\\n            <ion-button size=\\\"small\\\" (click)=\\\"incrementFilterPeriod(+1)\\\"><ion-icon name=\\\"return-right\\\"></ion-icon></ion-button>\\r\\n        </ion-col>\\r\\n\\r\\n      </ion-row>\\r\\n    </ion-grid>\\r\\n  </ion-item-divider>\\r\\n\\r\\n  <div style=\\\"display: block\\\">\\r\\n    <canvas baseChart\\r\\n                [data]=\\\"chartData\\\"\\r\\n                [labels]=\\\"chartLabels\\\"\\r\\n                [chartType]=\\\"chartType\\\"\\r\\n                [colors]=\\\"chartColors\\\"\\r\\n                (chartHover)=\\\"chartHovered($event)\\\"\\r\\n                (chartClick)=\\\"chartClicked($event)\\\"></canvas>\\r\\n  </div>\\r\\n\\r\\n  <ion-card>\\r\\n      <div class=\\\"ion-text-center\\\" style=\\\"width: 100%;\\\">\\r\\n        <ion-icon name=\\\"speedometer\\\" size=\\\"small\\\"></ion-icon>\\r\\n        <ion-label class=\\\"slide_num\\\" *ngIf=\\\"getFilterPeriodString()=='All'\\\"> Total Mileage: {{getMileage()}} km</ion-label>\\r\\n        <ion-label *ngIf=\\\"getFilterPeriodString()!='All'\\\" class=\\\"slide_num\\\"> {{getFilterPeriodString()}} Total Mileage: {{getMileage()}} km</ion-label><br>\\r\\n        <ion-col *ngFor=\\\"let vehicle of database.current.stats.most_recent_drive_by_vehicle_type | keyvalue\\\">\\r\\n          {{vehicle.key}} : {{getMileagebyVehicleType(vehicle.key)}}\\r\\n        </ion-col>\\r\\n      </div>\\r\\n  </ion-card>\\r\\n\\r\\n  <ion-card *ngFor=\\\"let trip of getDrives()\\\">\\r\\n    <br>\\r\\n    <app-drive-view expandHeight='150px' expandWidth='100px' [drive]=\\\"trip\\\"></app-drive-view>\\r\\n  </ion-card>\\r\\n\\r\\n</ion-content>\\r\\n<!--\\r\\n    <ion-row >\\r\\n      <ion-col align=\\\"center\\\">\\r\\n      <ion-card >\\r\\n    <ion-card-header>\\r\\n      <ion-card-subtitle>\\r\\n          <ion-item class=\\\"card\\\">\\r\\n          <ion-label position=\\\"floating\\\"></ion-label>\\r\\n          <ion-input disabled type=\\\"date\\\" name=\\\"text_drivedate\\\" color=\\\"success\\\">  </ion-input>\\r\\n            </ion-item>\\r\\n        </ion-card-subtitle>\\r\\n      <ion-card-title>\\r\\n        <ion-item class=\\\"card\\\" >\\r\\n          <ion-label color=\\\"success\\\" position=\\\"floating\\\">VehicleType</ion-label>\\r\\n          <ion-input color=\\\"success\\\" disabled type=\\\"number\\\" name=\\\"text_drivevehicletype\\\">  </ion-input>\\r\\n            </ion-item>\\r\\n    </ion-card-title>\\r\\n    </ion-card-header>\\r\\n  \\r\\n    <ion-card-content>\\r\\n      \\r\\n      <ion-grid>\\r\\n        <ion-row>\\r\\n          <ion-col >\\r\\n            <ion-item class=\\\"card\\\">\\r\\n          <ion-label color=\\\"success\\\" position=\\\"floating\\\">Total Time Driven</ion-label>\\r\\n          <ion-input disabled type=\\\"number\\\" name=\\\"text_driveduration\\\" color=\\\"success\\\">  </ion-input>\\r\\n            </ion-item>\\r\\n          </ion-col>\\r\\n          <ion-col>\\r\\n            <ion-item class=\\\"card\\\">\\r\\n          <ion-label color=\\\"success\\\" position=\\\"floating\\\">Total Mileage</ion-label>\\r\\n          <ion-input disabled type=\\\"number\\\" name=\\\"text_drivemileage\\\" color=\\\"success\\\">  </ion-input>\\r\\n            </ion-item>\\r\\n          </ion-col>\\r\\n        </ion-row>\\r\\n      </ion-grid>\\r\\n\\r\\n    </ion-card-content>\\r\\n  </ion-card>\\r\\n\\r\\n      </ion-col>\\r\\n    </ion-row>\\r\\n-->\\r\\n\\r\\n\"","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { HistoryPage } from './history.page';\r\nimport { DriveViewModule } from '../../drive-view/drive-view.module';\r\nimport { ChartsModule } from 'ng2-charts';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: HistoryPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    RouterModule.forChild(routes),\r\nDriveViewModule,\r\nChartsModule\r\n  ],\r\n  declarations: [HistoryPage\r\n  ]\r\n})\r\nexport class HistoryPageModule {}\r\n","export default \".vertical-align-content > * {\\n  display: -webkit-box !important;\\n  display: flex !important;\\n  align-content: center !important;\\n  -webkit-box-align: center !important;\\n          align-items: center !important;\\n  -webkit-box-pack: center !important;\\n          justify-content: center !important; }\\n\\n.custom-font-size {\\n  font-size: 0.8em; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvaGlzdG9yeS9DOlxcVXNlcnNcXFJ1aVxcQW5kcm9pZFN0dWRpb1Byb2plY3RzXFxFbmdpbmVlcnNMb2dib29rMi9zcmNcXGFwcFxccGFnZXNcXGhpc3RvcnlcXGhpc3RvcnkucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBRUssK0JBQXVCO0VBQXZCLHdCQUF1QjtFQUN2QixnQ0FBK0I7RUFDL0Isb0NBQTZCO1VBQTdCLDhCQUE2QjtFQUM3QixtQ0FBa0M7VUFBbEMsa0NBQWtDLEVBQUE7O0FBRXZDO0VBQ0ksZ0JBQWdCLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9wYWdlcy9oaXN0b3J5L2hpc3RvcnkucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLnZlcnRpY2FsLWFsaWduLWNvbnRlbnQgPiAqXHJcbntcclxuICAgICBkaXNwbGF5OiBmbGV4IWltcG9ydGFudDtcclxuICAgICBhbGlnbi1jb250ZW50OiBjZW50ZXIhaW1wb3J0YW50O1xyXG4gICAgIGFsaWduLWl0ZW1zOiBjZW50ZXIhaW1wb3J0YW50OyAgLy8gdmVydGljYWwgYWxpZ25tZW50XHJcbiAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXIgIWltcG9ydGFudDsgIC8vIGhvcml6b250YWwgYWxpZ25tZW50XHJcbn1cclxuLmN1c3RvbS1mb250LXNpemUge1xyXG4gICAgZm9udC1zaXplOiAwLjhlbTtcclxufSJdfQ== */\"","import { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\r\nimport { DatabaseService, Drive, VehicleTypes } from '../../services/database.service';\r\nimport * as dayjs from 'dayjs'; // DateTime utility, See http://zetcode.com/javascript/dayjs/\r\nimport { Chart } from \"chart.js\";\r\nimport { PipesModule } from '../../pipes/pipes.module';\r\nimport 'chartjs-plugin-labels';\r\nimport 'chartjs-chart-radial-gauge';\r\nimport 'chartjs-tsgauge';\r\nimport {ChartsModule, Color} from 'ng2-charts';\r\nimport { Geolocation } from '@ionic-native/geolocation/ngx';\r\n\r\n@Component({\r\n  selector: 'app-history',\r\n  templateUrl: './history.page.html',\r\n  styleUrls: ['./history.page.scss'],\r\n})\r\nexport class HistoryPage implements OnInit {\r\n\r\n  select_month: number = 0;\r\n  select_year: number = 0;\r\n  \r\n  constructor(\r\n    private database: DatabaseService,\r\n    private geolocation: Geolocation,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.buildChart();\r\n    let watch = this.geolocation.watchPosition();\r\n    watch.subscribe((data) => {\r\n      if ( ( parseFloat(data.coords.latitude.toFixed(9)), parseFloat(data.coords.longitude.toFixed(9)) ) != (this.database.current.user.location.lat, this.database.current.user.location.lng) )\r\n      { this.database.current.user.location = {lat: parseFloat(data.coords.latitude.toFixed(9)),lng: parseFloat(data.coords.longitude.toFixed(9))};\r\n        console.log(this.database.current.user.location);\r\n        console.log(\"write\");\r\n        this.database.write('user', this.database.current.user.email, this.database.current.user);\r\n      }\r\n    });\r\n  }\r\n\r\n  public getMileage() {\r\n    var mileage = 0;\r\n    var drives = this.getDrives();\r\n    for (var d of drives) {\r\n      mileage += d.end_odometer - d.start_odometer }\r\n    return mileage;\r\n  }\r\n\r\n  getMileagebyVehicleType(vehicle: string) {\r\n    var mileage = 0;\r\n    var drives = this.getDrives();\r\n    for (var d of drives) {\r\n      if (d.vehicle_type == vehicle) {\r\n        mileage += d.end_odometer - d.start_odometer }\r\n      }\r\n    return mileage;\r\n  }\r\n\r\n  public getDrives() : Drive[] {\r\n\r\n    var drives = this.database.current.drive_history;\r\n    var vtype = (<HTMLInputElement>document.getElementById(\"vehitype\")).value;\r\n    if (!this.select_month && !this.select_year) {\r\n      if (vtype != \"ALL\") {\r\n        return drives.filter( (drive) => drive.vehicle_type == vtype);\r\n      }\r\n      return drives\r\n    }\r\n    else {\r\n      if (vtype != \"ALL\") {\r\n        var  a = drives.filter( (drive) => drive.vehicle_type == vtype);\r\n        return a.filter( (drive) => {\r\n          var elem = drive.date.split(\"-\");\r\n          return (!this.select_year||parseInt(elem[0])==this.select_year)\r\n            && (!this.select_month||parseInt(elem[1])==this.select_month);\r\n        });\r\n      }\r\n      return drives.filter( (drive) => {\r\n        var elem = drive.date.split(\"-\");\r\n        return (!this.select_year||parseInt(elem[0])==this.select_year)\r\n          && (!this.select_month||parseInt(elem[1])==this.select_month);\r\n      });\r\n    }\r\n  }\r\n\r\n  /*public getDrives() : Drive[] {\r\n\r\n    var drives = this.database.current.drive_history;\r\n\r\n    if (!this.select_month && !this.select_year) return drives; // No filter\r\n\r\n    return drives.filter( (drive) => {\r\n      var elem = drive.date.split(\"-\");\r\n      return (!this.select_year||parseInt(elem[0])==this.select_year) \r\n        && (!this.select_month||parseInt(elem[1])==this.select_month);\r\n    });\r\n  }*/\r\n  \r\n  public getFilterPeriodString(): string {\r\n    if (this.select_month==0 || this.select_year==0) {\r\n      return \"All\";\r\n    } else {\r\n      const dt = dayjs(new Date(this.select_year, this.select_month-1, 1));  // months in dayjs, Jan=0\r\n      return dt.format(\"MMMM, YYYY\");\r\n    }\r\n  }\r\n  \r\n  public incrementFilterPeriod(delta: number) {\r\n\r\n    const today = dayjs();\r\n\r\n    var changed: boolean = true;\r\n    \r\n    if (delta==-1) {\r\n      if (!this.select_month || !this.select_year) {\r\n        // Current month/year\r\n        this.select_month = today.month()+1;\r\n        this.select_year = today.year();\r\n      } else {\r\n        this.select_month--;\r\n        if (this.select_month==0) { \r\n          // Roll back to previous year\r\n          this.select_year--; \r\n          this.select_month = 12;\r\n        }\r\n      }\r\n    } else {\r\n      if (!this.select_month || !this.select_year) {\r\n        // Can't increment\r\n        changed = false;\r\n      } else {\r\n        // When incrementing beyond current month/year, select \"all\"\r\n        if (this.select_year==today.year() && (this.select_month-1)==today.month()) {\r\n          this.select_year = this.select_month = 0;\r\n        } else {\r\n          this.select_month++;\r\n          if (this.select_month==13) { \r\n            // Roll over to next year\r\n            this.select_year++; \r\n            this.select_month = 1;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (changed) this.buildChart();\r\n  }\r\n\r\n  // Build Doughnut chart of mileage per VehicleType\r\n  public chartLabels:string[] = Object.keys(this.database.current.stats.most_recent_drive_by_vehicle_type);\r\n  public chartData:number[] = [ 0,0,0,0 ];\r\n  public chartType:string = 'doughnut';\r\n  public chartColors:any[] = [{backgroundColor: [\r\n            \"rgba(255,99,132,0.2)\",\r\n            \"rgba(54, 162, 235,0.2)\",\r\n            \"rgba(255, 206, 86,0.2)\",\r\n            \"rgba(75, 192, 192,0.2)\",\r\n            \"rgba(153, 102, 255,0.2)\",],\r\n            borderColor: [\r\n            \"rgba(255,99,132, 1)\",\r\n            \"rgba(54, 162, 235, 1)\",\r\n            \"rgba(255, 206, 86, 1)\",\r\n            \"rgba(75, 192, 192, 1)\",\r\n            \"rgba(153, 102, 255, 1)\",]\r\n            }];\r\n\r\n  private buildChart(): void {\r\n\r\n    var count:number[] = Array(this.chartLabels.length).fill(0)\r\n    \r\n    this.getDrives().map( (trip) => {\r\n      var valid_type = false;\r\n      for (let i=0; i<this.chartLabels.length; i++) {\r\n        if (trip.vehicle_type === this.chartLabels[i]) {\r\n          count[i] += this.database.distance(trip);\r\n          valid_type = true;\r\n        }\r\n      }\r\n      if (!valid_type) { console.log(`### Error: Invalid vehicle type: ${trip.vehicle_type} in ${trip.id}`); }\r\n    });\r\n    \r\n    //console.log(`>buildChart() = ${count}`);\r\n    this.chartData = count;\r\n  }\r\n  \r\n  public chartClicked(e:any):void {\r\n    //console.log(e);\r\n  }\r\n  public chartHovered(e:any):void {\r\n    //console.log(e);\r\n  }\r\n}\r\n"],"sourceRoot":"webpack:///"}